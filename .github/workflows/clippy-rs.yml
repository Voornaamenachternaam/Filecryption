name: rust-rs

permissions:
  contents: write
  checks: write
  pull-requests: write
  security-events: write
  statuses: write
  issues: write

on: 
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  workflow_dispatch: {}  # Allows manual trigger from GitHub Actions UI
  schedule:
    - cron: "0 2 * * *"

jobs:
    clippy_check:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v5.0.0
            - uses: actions-rs/toolchain@v1.0.7
              with:
                  toolchain: stable
                  components: clippy
                  override: true
            - uses: clechasseur/rs-clippy-check@v5.0.1
              with:
                  args: --all-features --message-format=json | clippy-sarif | tee rust-clippy-results.sarif | sarif-fmt
            - name: Upload analysis results to GitHub
              uses: github/codeql-action/upload-sarif@v4
              with:
                sarif_file: rust-clippy-results.sarif
                wait-for-processing: true
